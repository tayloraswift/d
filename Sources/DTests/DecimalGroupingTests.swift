import D
import Testing

@Suite enum DecimalGroupingTests {
    @Test static func Triple() {
        let a: Decimal = 123_12%
        #expect("\(a[/0])" == "123.12")
        #expect("\(a[/1])" == "1,2,3.12")
        #expect("\(a[/2])" == "1,23.12")
        #expect("\(a[/3])" == "123.12")

        let b: Decimal = -456_12%
        #expect("\(b[/0])" == "−456.12")
        #expect("\(b[/1])" == "−4,5,6.12")
        #expect("\(b[/2])" == "−4,56.12")
        #expect("\(b[/3])" == "−456.12")
    }
    @Test static func TripleExplicitPrecision() {
        let a: Decimal = 123_12%
        #expect("\(a[/0..3])" == "123.120")
        #expect("\(a[/1..3])" == "1,2,3.120")
        #expect("\(a[/2..3])" == "1,23.120")
        #expect("\(a[/3..3])" == "123.120")

        let b: Decimal = -456_12%
        #expect("\(b[/0..3])" == "−456.120")
        #expect("\(b[/1..3])" == "−4,5,6.120")
        #expect("\(b[/2..3])" == "−4,56.120")
        #expect("\(b[/3..3])" == "−456.120")
    }
    @Test static func TriplePercent() {
        let a: Decimal = 123_12%
        #expect("\(a[/0%])" == "12312%")
        #expect("\(a[/1%])" == "1,2,3,1,2%")
        #expect("\(a[/2%])" == "1,23,12%")
        #expect("\(a[/3%])" == "12,312%")

        let b: Decimal = -456_12%
        #expect("\(b[/0%])" == "−45612%")
        #expect("\(b[/1%])" == "−4,5,6,1,2%")
        #expect("\(b[/2%])" == "−4,56,12%")
        #expect("\(b[/3%])" == "−45,612%")
    }
    @Test static func TriplePercentExplicitPrecision() {
        let a: Decimal = 123_12%
        #expect("\(a[/0%1])" == "12312.0%")
        #expect("\(a[/1%1])" == "1,2,3,1,2.0%")
        #expect("\(a[/2%1])" == "1,23,12.0%")
        #expect("\(a[/3%1])" == "12,312.0%")

        let b: Decimal = -456_12%
        #expect("\(b[/0%1])" == "−45612.0%")
        #expect("\(b[/1%1])" == "−4,5,6,1,2.0%")
        #expect("\(b[/2%1])" == "−4,56,12.0%")
        #expect("\(b[/3%1])" == "−45,612.0%")
    }

    @Test static func Large() {
        let a: Decimal = 123456789123_12%
        #expect("\(a[/0])" == "123456789123.12")
        #expect("\(a[/1])" == "1,2,3,4,5,6,7,8,9,1,2,3.12")
        #expect("\(a[/2])" == "12,34,56,78,91,23.12")
        #expect("\(a[/3])" == "123,456,789,123.12")

        let b: Decimal = -987654321098_12%
        #expect("\(b[/0])" == "−987654321098.12")
        #expect("\(b[/1])" == "−9,8,7,6,5,4,3,2,1,0,9,8.12")
        #expect("\(b[/2])" == "−98,76,54,32,10,98.12")
        #expect("\(b[/3])" == "−987,654,321,098.12")
    }

    @Test static func LargeWithRemainder() {
        let a: Decimal = 1234567890_12%
        #expect("\(a[/0])" == "1234567890.12")
        #expect("\(a[/1])" == "1,2,3,4,5,6,7,8,9,0.12")
        #expect("\(a[/2])" == "12,34,56,78,90.12")
        #expect("\(a[/3])" == "1,234,567,890.12")

        let b: Decimal = -9876543210_12%
        #expect("\(b[/0])" == "−9876543210.12")
        #expect("\(b[/1])" == "−9,8,7,6,5,4,3,2,1,0.12")
        #expect("\(b[/2])" == "−98,76,54,32,10.12")
        #expect("\(b[/3])" == "−9,876,543,210.12")
    }

    @Test static func LargeWithLeadingPlus() {
        let a: Decimal = 1234567890_12%
        #expect("\(+a[/0])" == "+1234567890.12")
        #expect("\(+a[/1])" == "+1,2,3,4,5,6,7,8,9,0.12")
        #expect("\(+a[/2])" == "+12,34,56,78,90.12")
        #expect("\(+a[/3])" == "+1,234,567,890.12")

        let b: Decimal = -9876543210_12%
        #expect("\(+b[/0])" == "−9876543210.12")
        #expect("\(+b[/1])" == "−9,8,7,6,5,4,3,2,1,0.12")
        #expect("\(+b[/2])" == "−98,76,54,32,10.12")
        #expect("\(+b[/3])" == "−9,876,543,210.12")
    }
}
